[
  {
    "objectID": "posts/intro_to_projects/index.html",
    "href": "posts/intro_to_projects/index.html",
    "title": "intRos: Managing research projects with R Studio",
    "section": "",
    "text": "When we‚Äôre doing research, we often find ourselves working on more than one research project at time. Managing multiple folders of data and code can be confusing enough, but when we throw R into the mix, things can get messy very quickly. A large part of the confusion comes from how most folks manage research projects on their own system ‚Äî which was been aptly summarised by the wonderful Jenny Bryan:\n\nIf the first line of your R script is\nsetwd(\"C:\\Users\\jenny\\path\\that\\only\\I\\have\")\nI will come into your office and SET YOUR COMPUTER ON FIRE üî•.\nIf the first line of your R script is\nrm(list = ls())\nI will come into your office and SET YOUR COMPUTER ON FIRE üî•.\n\nWhile I won‚Äôt come and set your computer on fire (especially because I have committed both of these coding crimes in the past), I do want to teach you about two really useful tools for making your life easier for managing research projects, and much nicer for sharing code with collaborators.These two tools are R Studio projects and the here package."
  },
  {
    "objectID": "posts/intro_to_projects/index.html#the-magic-of-rstudio-and-projects",
    "href": "posts/intro_to_projects/index.html#the-magic-of-rstudio-and-projects",
    "title": "intRos: Managing research projects with R Studio",
    "section": "The Magic of RStudio and Projects",
    "text": "The Magic of RStudio and Projects\nR Studio is great, and if you don‚Äôt already use it I‚Äôd highly recommend starting now! R Studio is what we‚Äôd call a IDE (Integrated Development Environment) that allows us to integrate with R to do much more than execute code. Despite its wide use in the science community, there‚Äôs one bit of functionality that seems to regularly overlooked by many folks: ‚ÄúProjects‚Äù. These files ‚Äî which you can start to explore from the drop-down menu in the top-right of R Studio ‚Äî are designed for compartmentalising your work into separate contexts, which are great if you have multiple research projects on the go at once.\nRStudio projects resolve the issue of rm(list = ls()) by creating a separate R Studio instance for each new project, each with its own R session, environment, temporary files and working directory (see next section on the ‚Äòhere‚Äô package for more on filepaths).\nIf we navigate to New Project... (either from File or the drop-down Projects toolbar in the top-right), we are given the option of creating a new R Studio project in one of three ways:\n\nNew directory (i.e.¬†start from an empty folder)\nExisting directory (when you already have a folder of code and data that you want to turn into a project)\nVersion control (when you want to start version control of a project ‚Äî see Next steps section for more info on this)\n\nMost of the time you‚Äôll be starting a new project in an empty folder, so we‚Äôll use the New Directory option:\n\n\n\n\n\nNext you‚Äôre provided with a bunch of alternate project types, but we‚Äôll go for the New Project option:\n\n\n\n\n\nLastly, we get to choose the directory name (this is the name the project folder will have, so make sure it identifies your project clearly) and where this directory will be saved (i.e where on your computer you want to keep your research project folders):\nNote: If you tick the box to open in a new session (circled red), whatever you‚Äôre currently working on in R Studio won‚Äôt have to be saved and closed.\n\n\n\n\n\nAnd that‚Äôs it! You now have a nice folder ready to fill with data and code, and never need to use rm(list = ls()) ever again. R Studio also did a couple of things for us in the background when we hit the Create Project button:\n\nCreated an .Rproj file in the top level of the folder (can be used to directly open each project in a new session, and also contains various options for project-specific settings)\nCreated a hidden directory .Rproj.user where project-specific temporary files are stored (useful if you have a session terminate unexpectedly)\nLoaded the project into R Studio, with the project name displayed in the Projects toolbar (top-right) and also in front of the RStudio icon in the task bar (appearance differs between macOS and Windows)\nWhile your root filepath would normally have started at the top of your disk drive, it should now start wherever the Project‚Äôs .Rproj file is (you‚Äôll see this pathn when you first load here). So no more writing ‚Äî C:\\extremely\\long\\filepath\\that\\only\\I\\have every time (BUT see next section on the here package for making this even better)."
  },
  {
    "objectID": "posts/intro_to_projects/index.html#best-practices-for-structuring-project-folders",
    "href": "posts/intro_to_projects/index.html#best-practices-for-structuring-project-folders",
    "title": "intRos: Managing research projects with R Studio",
    "section": "Best practices for structuring project folders",
    "text": "Best practices for structuring project folders\nOnce a project is created, it‚Äôs worth adding folders to contain each of the relevant types of data for your research. For most of us this usually means something like the following: raw_data, code, outputs (folders should only contain data relevant to the research project).\n\n\n\n\n\nExample of what your sub-folders might look like inside your Project folder (adapted from Martin Chan‚Äôs beginner‚Äôs guide to using R Studio projects)"
  },
  {
    "objectID": "posts/intro_to_projects/index.html#building-robust-filepaths-with-the-here-package",
    "href": "posts/intro_to_projects/index.html#building-robust-filepaths-with-the-here-package",
    "title": "intRos: Managing research projects with R Studio",
    "section": "Building robust filepaths with the here package",
    "text": "Building robust filepaths with the here package\nR Studio projects go a long way to making simpler filepaths for our code by removing the need for absolute filepaths (which are specific to your system), and introducing relative filepaths (i.e.¬†ones that start at the location of .Rproj file). That said, we can make things even better and more reproducible by making use of the here package. here helps make filepaths consistent between different operating systems. For example, while macOS users have filepaths separated by forward slashes (/), windows users have filepaths with backward slashes (\\). This means that even with the shorter relative filepaths we get when using Projects, paths like raw_data/2023.csv will only work for macOS users, and if you share this fragile code with someone using Windows it will just throw errors.\nIn comes the here package to the rescue ‚Äî we can use it to make reproducible filepaths that work for everyone! here works in a similar way to file.path, where we build a path to a folder or file by listing elements of the path as arguments. For example, if we had some data in a project sub folder of raw_data called 2023.csv, we‚Äôd make a reproducible filepath to it by writing here(\"raw_data, \"2023.csv\"). here does some helpful stuff in the background by a) adding our project‚Äôs root directory (which you can look at by just running here()), b) starts evaluating path from the project up (which file.path doesn‚Äôt), and c) all while using the right / or \\ delimiter depending on your system!\nWhen you want to actually use a filepath for say, reading some data with read_csv, you just have to provide the here function and folder arguments wherever you‚Äôd normally be putting a Users/stephen's/long/winded/filepath/to/a/file:\n\ninstall.packages(\"here\") #install\nlibrary(here) #load\n\nhere() #this will magically show the project root directory on your machine\nhere(\"raw_data\", \"2019.csv\") #this builds a filepath for where you want to go\nread_csv(file = here(\"raw_data\", \"2019.csv\")) #build this same filepath in read_csv"
  },
  {
    "objectID": "posts/intro_to_projects/index.html#next-steps",
    "href": "posts/intro_to_projects/index.html#next-steps",
    "title": "intRos: Managing research projects with R Studio",
    "section": "Next steps",
    "text": "Next steps\nUsing these two sets of tools together, you‚Äôre now primed to do some reproducible science on as many different projects as you want! But how can we go about sharing this with other researchers if we wanted to? While you can technically share the entire project folder with collaborators directly, we can also use version control software and online repositories to manage changes to our code and make it accessible. The main way folks do this is using git and GitHub, and we will do a later post on how to get set up with both in due course.\nintRo to using git, GitHub & R Studio (post coming soon)"
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html",
    "href": "posts/intro_to_ggplot2/index.html",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "",
    "text": "I love making graphs! To explore data, to plot model results, just for the fun of making plots. I imagine we have all spent a huge amount of time making our plots ready for publication. Here we have a quick walkthrough of using ggplot2 to create graphs for publication, and a few tips and tricks we have learned along the way. If you have a favourite ggplot2 trick or tip then we would love for you to get in contact with us and for you add it to this walkthrough. Or if you‚Äôre feeling adventurous, clone the GitHub repo, add in your tip, re-render this quarto post, commit and push the changes, and start a Pull Request!\nggplot2 is a popular data visualisation package in R that allows users to create high-quality and customisable graphics for data exploration, scientific publications, and presentations. Developed by Hadley Wickham, ggplot2 is built on the principles of the Grammar of Graphics, which defines a set of rules for constructing and interpreting visualisations. With ggplot2, users can easily create a wide range of plots with advanced features such as facets, themes, and labels. Whether you are at the beginning of your science journey, or an old and grumpy PI, ggplot2 provides a powerful and flexible tool for visualising data and gaining insights from it.\nMaking a ggplot2 is like writing and following a recipe. You start with the first instructions (a call to ggplot()), the next instruction (like the next item of the recipe) is signalled using a +, a new line, and new instructions are added sequentially. ggplot2 works in a sequential fashion, later instructions add to what is already there, and sometimes counteract or override what previous instructions.\n\n\n\nMaking a plot using ggplot2 works much like a recipe"
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html#preparing-your-dataset-for-ggplot2",
    "href": "posts/intro_to_ggplot2/index.html#preparing-your-dataset-for-ggplot2",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "Preparing your dataset for ggplot2",
    "text": "Preparing your dataset for ggplot2\nFor ggplot2, your data wants to be organised in long format, as opposed to wide."
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html#make-a-first-plot-using-ggplot2",
    "href": "posts/intro_to_ggplot2/index.html#make-a-first-plot-using-ggplot2",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "Make a first plot using ggplot2",
    "text": "Make a first plot using ggplot2\nWe will make a boxplot of how bill length changes between different species of penguin and add the raw points over the top. After making an initial plot call using ggplot(), different types of plot are specified using a geom_ function (e.g.¬†geom_boxplot() for boxplots, geom_point() for points, geom_line() for a line graph). In each layer, the aes() function is used to tell ggplot2 which arguments depend on aspects of the dataset (e.g.¬†col = species). Arguments set outside of aes() do not rely on the dataset (e.g.¬†size = 3, col = ‚Äòblack‚Äô).\n\n# make first box plot with raw points\nggplot(d, aes(species, bill_length_mm, col = species)) + # add first empty plot layer\n  geom_boxplot(outlier.shape = NA) + # add boxplot, do not plot the outliers\n  geom_jitter(width = 0.2) # add jittered raw points\n\n\n\n\n\n\n\n\nOk this looks nice. Here I put the aes() commands inside the original call to ggplot() as then those arguments are passed to all other layers (unless overridden by another aes()). This looks quite nice, but we can change a bunch of other things to make it look nicer."
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html#adding-extra-layers-to-ggplot2",
    "href": "posts/intro_to_ggplot2/index.html#adding-extra-layers-to-ggplot2",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "Adding extra layers to ggplot2",
    "text": "Adding extra layers to ggplot2\nThere are a bunch of things I do as standard when I am making a plot (and a boxplot in particular):\n\nChange the axis labels\nRemove the legend if not needed\nChange the axis limits\nChange the theme and the text size\nI dislike the default box plot so I colour the whole thing and then add a median bar in white (see below)\n\nThe important thing is to create your own style. To do what you think looks best, but all the options are documented nicely on their website. There are many more detailed resources around, so instead here we will document common things we do.\n\n# make next box plot with raw points\np1 <- ggplot(d, aes(species, bill_length_mm, col = species, fill = species)) + # add first empty plot layer\n  geom_boxplot(outlier.shape = NA) + # add boxplot, do not plot the outliers\n  stat_summary(geom = \"crossbar\", fatten = 2, color = \"white\", width = 0.4, \n               fun.data = function(x){return(c(y = stats::median(x), ymin = stats::median(x), ymax = stats::median(x)))}) + # add median line to the boxplots\n  geom_jitter(width = 0.2, shape = 21, fill = 'white') + # add jittered raw points\n  theme_bw(base_size = 14) + # change theme to the one I like (others are available)\n  labs(x = 'Species',\n       y = 'Bill length (mm)',\n       title = 'Do different penguin species have different bill lengths?') + # change labels\n  ylim(c(30,65)) + # change y limits\n  guides(col = 'none',\n         fill = 'none') # turn off legend\n\np1\n\n\n\n\n\n\n\n\nAnd there - with relatively few lines of code - we have a plot that is ready for inserting into a publication. This can be easily saved out using ggsave()\n\n# save out plot using ggsave\nggsave('plot_one.png', p1, width = 5, height = 7)"
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html#our-favourite-tips-and-tricks-when-making-plots",
    "href": "posts/intro_to_ggplot2/index.html#our-favourite-tips-and-tricks-when-making-plots",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "Our favourite tips and tricks when making plots",
    "text": "Our favourite tips and tricks when making plots\nI have a set of rules I follow when making plots with ggplot2. Some may be different to yours but they might have some use:\n\nGenerally I make my datasets BEFORE they go into ggplot2. This includes checking for NA and Inf values as these are super important to know about when visualising and analysing your data!\n\nPlot the raw data whenever possible.\n\nLayers work iteratively (later layers go on top of earlier layers) so make sure layers you want to be in the background (e.g.¬†boxplot) are before layers you want to overlay (e.g.¬†the raw data)\nOnly use stat_smooth() for exploring datasets. When plotting model predictions and confidence intervals, create a dataframe for them and then feed that into ggplot2.\n\n\nConvert text size in geom_label() or geom_text() to pts used for labels\nLets say we wanted to add text to the plot. For example, in the plot above maybe we want to add the total number of penguins sampled for each species. By default geom_text() and geom_label() use a size guide that is different to the font size set for the axis and tick labels. However, Andrew Heiss has written a function to convert between those so we can easily define the font size in the regular way.\nWe will use functions from the tidyverse to create a data frame with the total number of penguins sampled and the max bill length for each penguin. Creating a data frame with the x and y coordinates of where I want the text to go on the plot, and a column for the label, is how I approach adding text labels to an existing ggplot.\n\n# define function for pts\npts <- function(x){\n    as.numeric(grid::convertX(grid::unit(x, \"points\"), \"mm\"))\n  }\n\n# calculate n for putting each species\n# remove NAs because they are not in the plot\nd_n <- filter(d, !is.na(bill_length_mm)) %>%\n  group_by(species) %>%\n  summarise(n = n(),\n            max_bill_length = max(bill_length_mm)) %>%\n  ungroup()\n\n# make plot with text\n# make next box plot with raw points\np1 +\n  geom_text(aes(x = species, y = max_bill_length + 5, label = paste('n = ', n, sep = '')), d_n, size = pts(12), col = 'black') # add text label\n\n\n\n\n\n\n\n\n\n\nSoft wrap or stagger text labels to stop them overlapping\nOk these two are quite recent finds for me, and I absolutely love them. Sometimes your x labels might be really long, and the text can overlap with each other. I used to manually add new lines into my text by inserting \\n where I wanted new text to me. But now two approaches exist that can automatically improve spacing between labels on the x axis. These are scales::label_wrap which can automatically create new lines for long axis labels and guide_axis() which can stagger axis labels to prevent overlapping.\nWe will demonstrate them both below, by adding the Latin names for each penguin species to the dataset. We will add them in using case_when() and then show both plots next to each other using patchwork which makes it really easy to combine individual plots. For free you also get code to italicise the axis labels as they are latin names!\n\nd <- mutate(d, latin_name = case_when(species == \"Gentoo\" ~ \"Pygoscelis papua\",\n                                      species == \"Chinstrap\" ~ \"Pygoscelis antarcticus\",\n                                      species == \"Adelie\" ~ \"Pygoscelis adeliae\"))\n\n# first to softwrap the text\np2 <- ggplot(d, aes(latin_name, bill_length_mm, col = species, fill = species)) + # add first empty plot layer\n  geom_boxplot(outlier.shape = NA) + # add boxplot, do not plot the outliers\n  stat_summary(geom = \"crossbar\", fatten = 2, color = \"white\", width = 0.4, \n               fun.data = function(x){return(c(y = stats::median(x), ymin = stats::median(x), ymax = stats::median(x)))}) + # add median line to the boxplots\n  geom_jitter(width = 0.2, shape = 21, fill = 'white') + # add jittered raw points\n  theme_bw(base_size = 14) + # change theme to the one I like (others are available)\n  labs(x = 'Species',\n       y = 'Bill length (mm)') + # change labels\n  ylim(c(30,65)) + # change y limits\n  guides(col = 'none',\n         fill = 'none') + # turn off legend\n  theme(axis.text.x = element_text(face = \"italic\")) + # italicise x axis labels\n  scale_x_discrete(labels = scales::label_wrap(10)) # soft wrap labels\n\np3 <- p2 +\n  scale_x_discrete(guide = guide_axis(n.dodge = 2)) # stagger axis labels\n\np2 + p3\n\n\n\n\n\n\n\n\nEither of these look great, but I think scales::label_wrap() is my favourite. So simple and so effective!\n\n\nAutomatically label facets with letters\nOne thing I often do is create faceted plots where each plot represents a different treatment or subset of the data. This is really easy to do with ggplot2 using facet_wrap(). However, the default facets are poorly labelled, are not numbered (generally with a, b, c for publications), and have a grey fill colour.\nHowever, these are all issues we can solve to create publication-ready facet labels. We will demonstrate this by plotting a different trait on each facet (bill length, bill depth, flipper length, body mass). We will create the long data using pivot_longer() and use case_when() to make sure the labels on each facet are formatted correctly (i.e.¬†spaces instead of underscores.\nWe can write a function to automatically label each facet, and change theme elements to align text and change the strip background colour.\n\nlong_format <- d %>%\n  mutate(id = 1:n()) %>% # create column to id each individual penguin\n  pivot_longer(., cols = c(bill_length_mm:body_mass_g), names_to = 'trait', values_to = 'value') %>% # go from wide to long format for the traits\n  mutate(facet_label = case_when(trait == 'bill_length_mm' ~ \"Bill Length (mm)\",\n                                 trait == \"bill_depth_mm\" ~ \"Bill Depth (mm)\",\n                                 trait == \"body_mass_g\" ~ \"Body Mass (g)\",\n                                 trait == \"flipper_length_mm\" ~ \"Flipper Length (mm)\"))\n\n# create function to add letter to facet labels\nletter_facets <- function (string){\n    len <- length(string)\n    string = paste(\"(\", letters[1:len], \") \", string, sep = \"\")\n    return(string)\n}\n\n# create plot\nggplot(long_format, aes(species, value, col = species, fill = species)) + # add first empty plot layer\n  geom_boxplot(outlier.shape = NA) + # add boxplot, do not plot the outliers\n  stat_summary(geom = \"crossbar\", fatten = 2, color = \"white\", width = 0.4, \n               fun.data = function(x){return(c(y = stats::median(x), ymin = stats::median(x), ymax = stats::median(x)))}) + # add median line to the boxplots\n  geom_jitter(width = 0.2, shape = 21, fill = 'white') + # add jittered raw points\n  theme_bw(base_size = 14) + # change theme to the one I like (others are available)\n  labs(x = 'Species',\n       y = 'Trait measurement') + # change labels\n  guides(col = 'none',\n         fill = 'none') +\n  facet_wrap(~facet_label, scales = 'free_y', labeller = labeller(facet_label = letter_facets)) + # facet by the label column so the text is correct \n  theme(strip.background = element_blank(),\n        strip.text = element_text(hjust = 0))\n\n\n\n\n\n\n\n\nBINGO THIS LOOKS SHAMAZING.\n\n\nBeautiful colour schemes with MetBrewer\nI take a lot of time looking at colours to use in my plots. I have used viridis before, the colour schemes from colorbrewer, and Pok√©mon inspired colour schemes using palettetown. If you are so inclined, I have also started writing a small package (BrewerUoE) to access the new University of Exeter colours in R.\nHowever, the most beautiful colour schemes I have ever seen are those provided by MetBrewer, which are palettes inspired by works at the Metropolitan Museum of Art in New York. They are just sensational, and easy to add directly to your plots! We show an example how to below, but there are more examples on MetBrewer‚Äôs GitHub.\n\np1 + \n  scale_color_manual(values=met.brewer(\"Klimt\", 3)) +\n  scale_fill_manual(values=met.brewer(\"Klimt\", 3))\n\n\n\n\n\n\nAdd a final NULL layer to allow you to comment out layers\nIt is common for me to play around with different layers and switch some on and off with a hashtag. If you hash out the final layer then the layer before it with a + carries on to the next set of code. If you add a final + NULL to the plot then this behaviour doesn‚Äôt happen.\nLets say we wanted to see the plot without the text labels. We can turn them off by hashtagging them out (in case we want to add them back in later), and the final NULL means the plot still works.\n\np1 +\n  #geom_text(aes(x = species, y = max_bill_length + 5, label = paste('n = ', n, sep = '')), d_n, size = pts(12), col = 'black') + # add text label\n  NULL # add NULL layer to allow easy commenting out of layers"
  },
  {
    "objectID": "posts/intro_to_ggplot2/index.html#awesome-ggplot2-extensions",
    "href": "posts/intro_to_ggplot2/index.html#awesome-ggplot2-extensions",
    "title": "intRos: Publication ready plots using ggplot2",
    "section": "Awesome ggplot2 extensions",
    "text": "Awesome ggplot2 extensions\ngpgplot2 is so popular as a plotting system that it has become its own ecosystem, with people developing tools and extensions to complement and build extra functionality to ggplot2. All of the extensions can be found here, but below are some of our favourites:\n\nggdist which provides geoms and stats for visualising distributions and uncertainty.\nggtree to make phylogenetic trees using ggplot2.\npatchwork for combining separate plots.\npalettetown for Pok√©mon themed colour schemes. Whats better than Charizard colours!"
  },
  {
    "objectID": "posts/intro_to_flextable/index.html",
    "href": "posts/intro_to_flextable/index.html",
    "title": "intRos: Reproducible tables with flextable",
    "section": "",
    "text": "As scientists we make A LOT of tables, be it of summary statistics, model parameter values, contrast tables, or anything else. It used to be common practice to copy these individually into Excel or Word and then create a table to insert into your work, but this is prone to errors. No one is perfect after all.\nThis problem has now been solved by a bunch of different packages that allow for tables to be created in R and exported to a variety of formats. This means that fewer mistakes are made, that tables can easily be remade if the data or stats change, and that the process of making your tables is completely reproducible. The R package we will introduce to do this today is flextable, but there are other options available we won‚Äôt cover here such as gt and huxtable. I love flextable because it seems infinitely customisable and produces tables that are formatted beautifully to go into research articles.\nflextable provides an easy and flexible way to create tables for reporting and presentations. It allows for customization of the table appearance, including cell borders, font styles, background color, and more. The package also supports different formats such as HTML, Microsoft Word, and PowerPoint. It is well suited for creating reports and presentations with a high level of formatting, while still being simple and straightforward to use. Additionally, flextable has a number of features that make it particularly useful for data visualisation, including the ability to merge cells, add custom functions for data formatting, and control the appearance of the table based on data values (i.e.¬†making p values that are <0.05 bold).\nNote: There are likely to be more elegant ways to do some of the code we present here. If you know of a simpler/easier way then we would love for you to help contribute to this project."
  },
  {
    "objectID": "posts/intro_to_flextable/index.html#make-table-of-summary-stats",
    "href": "posts/intro_to_flextable/index.html#make-table-of-summary-stats",
    "title": "intRos: Reproducible tables with flextable",
    "section": "Make table of summary stats",
    "text": "Make table of summary stats\nIt is common to make tables summarising aspects of any given dataset. We will do that here with flextable. Lets say we want to know the averages and standard deviations of body mass, bill length and bill depth of the different penguins species split by sex.\nWe can easily do this using group_by() and summarise() in dplyr. More information on these functions can be found in our tidyverse intRo.\nAlso because I dislike the behavious of factors in R sometimes, we will first convert all columns that are factors into characters.\n\n# convert all columns that are factors into characters\nd <- mutate(d, across(where(is.factor), as.character))\n\n# create summary data\nd_summary <- group_by(d, species, sex) %>%\n  summarise(\n    # calculate number in each group\n    num_penguins = n(),\n    # can use across to apply the same functions to multiple columns\n    across(c(bill_length_mm, bill_depth_mm, body_mass_g), list(mean = ~mean(.x, na.rm = TRUE), sd = ~sd(.x, na.rm = TRUE))),\n    # specify we want to drop the groups\n    .groups = 'drop')\n\n# look at our table\nd_summary\n\n# A tibble: 8 √ó 9\n  species   sex    num_penguins bill_length_mm_mean bill_length_mm_sd\n  <chr>     <chr>         <int>               <dbl>             <dbl>\n1 Adelie    female           73                37.3              2.03\n2 Adelie    male             73                40.4              2.28\n3 Adelie    <NA>              6                37.8              2.80\n4 Chinstrap female           34                46.6              3.11\n5 Chinstrap male             34                51.1              1.56\n6 Gentoo    female           58                45.6              2.05\n7 Gentoo    male             61                49.5              2.72\n8 Gentoo    <NA>              5                45.6              1.37\n# ‚Ñπ 4 more variables: bill_depth_mm_mean <dbl>, bill_depth_mm_sd <dbl>,\n#   body_mass_g_mean <dbl>, body_mass_g_sd <dbl>\n\n\nWe can see there are some NAs for the sex of the penguins. We can make these unknown using replace_na().\n\n# replace NAs in our sex column\nd_summary <- mutate(d_summary, sex = replace_na(sex, 'unknown'))\n\nWe can immediately make this into a flextable using the flextable() function.\n\n# make our table into a flex table\ntable1 <- flextable(d_summary)\n\ntable1\n\n\nspeciessexnum_penguinsbill_length_mm_meanbill_length_mm_sdbill_depth_mm_meanbill_depth_mm_sdbody_mass_g_meanbody_mass_g_sdAdeliefemale7337.257532.02888317.621920.94299273,368.836269.3801Adeliemale7340.390412.27713119.072601.01888564,043.493346.8116Adelieunknown637.840002.80232018.320001.26964563,540.000477.1661Chinstrapfemale3446.573533.10866917.588240.78112773,527.206285.3339Chinstrapmale3451.094121.56455819.252940.76127303,938.971362.1376Gentoofemale5845.563792.05124714.237930.54024934,679.741281.5783Gentoomale6149.473772.72059415.718030.74105965,484.836313.1586Gentoounknown545.625001.37447014.550000.81034974,587.500338.1937\n\n\nThis already looks pretty good. But we can now add layers of formatting onto this table. The layers of formatting work much like the layers of ggplot2. You start with the base level and each new command creates new formatting of the whole table. Because of this, the order of the commands can make a big difference.\nFor this table, we will do a few different things:\n\nrename the column names\nmerge the species column vertically to only have one instance of species\nround the numbers to 2 decimal places\nchange the font and font size\nplay around with the column names to create a tiered column name for each trait (bill length, bill depth, body mass)\nadd in some horizontal lines to split species apart\n\nWe can do this by adding new layers using the %>%. Many of the functions involve you specifying what part you want the change to apply to (‚Äòall‚Äô, ‚Äòbody‚Äô, or ‚Äòheader‚Äô). Specific rows can be specified using the i argument, and columns using j.\nTo add a new header row, we need to create a new object which contains the text we want to add.\nFor each new thing we do, I have commented what the command is doing so that the code makes as much sense as possible.\n\n# text to be new header label\n# add same name for columns we want to merge later on\npars <- as_paragraph(\n  as_chunk(c('Species', 'Sex', 'n', 'Bill Length (mm)', 'Beak Length (mm)', 'Body Mass (g)'))\n)\n\n\n# edit table1\ntable1 <- flextable(d_summary) %>%\n  # rename all column names\n  set_header_labels(species = 'Species',\n                    sex = 'Sex',\n                    num_penguins = 'n',\n                    bill_length_mm_mean = 'mean',\n                    bill_length_mm_sd = 'sd',\n                    bill_depth_mm_mean = 'mean',\n                    bill_depth_mm_sd = 'sd',\n                    body_mass_g_mean = 'mean',\n                    body_mass_g_sd = 'sd') %>%\n  add_header_row(values = pars, colwidths = c(1, 1, 1, 2, 2, 2), top = TRUE) %>% # add header row\n  merge_v(j = c(1,2,3), part = 'header') %>%\n  merge_v(~species) %>% # merge multiple instances of the same species name\n  fix_border_issues() %>% # fix random border issues after merging\n  valign(valign = 'top', j = 1, part = 'body') %>% # align Species column\n  colformat_double(j = c(4,5,6,7,8,9), digits = 2) %>% # round numbers of specific columns to 2 decimal places\n  align(align = 'center', part = 'header') %>% # align column names centrally\n  align(align = 'left', part = 'body') %>% # align table output to the left\n  hline(i = c(3, 5), border = fp_border_default()) %>% # add in custom horizontal lines to split penguins up\n  font(fontname = 'Times', part = 'all') %>% # set font name for the table\n  fontsize(size = 12, part = 'all') %>% # set font size for the table\n  autofit()\n  \n# view table\ntable1\n\n\nSpeciesSexnBill Length (mm)Beak Length (mm)Body Mass (g)meansdmeansdmeansdAdeliefemale7337.262.0317.620.943,368.84269.38male7340.392.2819.071.024,043.49346.81unknown637.842.8018.321.273,540.00477.17Chinstrapfemale3446.573.1117.590.783,527.21285.33male3451.091.5619.250.763,938.97362.14Gentoofemale5845.562.0514.240.544,679.74281.58male6149.472.7215.720.745,484.84313.16unknown545.621.3714.550.814,587.50338.19\n\n\nThis is looking really good now! We can now export this table in a variety of formats (suitable for word documents, as an image or for powerpoint). I will write an exhaustive list of them here, but I generally like using an image for as long as possible so that I do not have as many formatting issues when putting tables into Microsoft Word or Google Docs.\n\n# save as image\nsave_as_image(table1, 'where/to/save/table1.png', webshot = 'webshot2')\n\n# save for word document\nsave_as_docx(table1, 'where/to/save/table1.docx', align = 'center')\n\n# save for powerpoint\nsave_as_pptx(table1, path = 'where/to/save/table1.docx')"
  },
  {
    "objectID": "posts/intro_to_flextable/index.html#make-table-of-model-parameters",
    "href": "posts/intro_to_flextable/index.html#make-table-of-model-parameters",
    "title": "intRos: Reproducible tables with flextable",
    "section": "Make table of model parameters",
    "text": "Make table of model parameters\nWe can use very similar methods to summarise parameters from statistical models. To demonstrate this, I will fit a linear model looking at how body mass is different between species of penguins. We will then use emmeans() to extract model parameters and put them into a table.\n\n# do models\nmod1 <- lm(body_mass_g ~ species, d)\nmod2 <- lm(body_mass_g ~ 1, d)\n\n# check for significance using an anova\nanova(mod1, mod2)\n\nAnalysis of Variance Table\n\nModel 1: body_mass_g ~ species\nModel 2: body_mass_g ~ 1\n  Res.Df       RSS Df  Sum of Sq      F    Pr(>F)    \n1    339  72443483                                   \n2    341 219307697 -2 -146864214 343.63 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# super different\n\n# grab estimates for each species using emmeans\nd_params <- emmeans(mod1, ~species)\n\nd_params\n\n species   emmean   SE  df lower.CL upper.CL\n Adelie      3701 37.6 339     3627     3775\n Chinstrap   3733 56.1 339     3623     3843\n Gentoo      5076 41.7 339     4994     5158\n\nConfidence level used: 0.95 \n\n\nWe can now turn this into a nice table using similar methods to those we used above.\n\n# text to be new header label\n# add same name for columns we want to merge later on\npars <- as_paragraph(\n  as_chunk(c('Species', 'Body Mass (g)', 'd.f.'))\n)\n\ndata.frame(d_params) %>%\n  # rejig column name orders to have degrees of freedom at the end\n  select(species, emmean, SE, lower.CL, upper.CL, df) %>%\n  flextable() %>%\n  set_header_labels(species = 'Species',\n                    emmean = 'Estimate',\n                    SE = 's.e.',\n                    df = 'd.f.',\n                    lower.CL = \"2.5%CI\",\n                    upper.CL = \"97.5%CI\") %>%\n  add_header_row(values = pars, colwidths = c(1, 4, 1), top = TRUE) %>% # add header row\n  merge_v(j = c(1,6), part = 'header') %>% # merge column names together\n  italic(j = c(3, 6), part = 'header') %>% # make some column names italic\n  colformat_double(j = c(2:5), digits = 2) %>% # round numbers of specific columns to 2 decimal places\n  align(align = 'center', part = 'header') %>% # align column names centrally\n  align(align = 'left', part = 'body') %>% # align table output to the left\n  font(fontname = 'Times', part = 'all') %>% # set font name for the table\n  fontsize(size = 12, part = 'all') %>% # set font size for the table\n  autofit() # fix any random size issues\n\n\nSpeciesBody Mass (g)d.f.Estimates.e.2.5%CI97.5%CIAdelie3,700.6637.623,626.673,774.66339Chinstrap3,733.0956.063,622.823,843.36339Gentoo5,076.0241.684,994.035,158.00339\n\n\nNice. This table can easily be extended to have other parameters in, and this approach can be reused for countless types of models."
  },
  {
    "objectID": "posts/intro_to_flextable/index.html#make-table-of-contrasts",
    "href": "posts/intro_to_flextable/index.html#make-table-of-contrasts",
    "title": "intRos: Reproducible tables with flextable",
    "section": "Make table of contrasts",
    "text": "Make table of contrasts\nAnother common thing we might want to do is look at which (if any) species have significantly different body mass to each other. We can do this by doing post-hoc contrasts between the different species, given we know there is a significant effect of species on body mass.\nAgain we can look at this using emmeans().\n\ncontrasts <- emmeans(mod1, pairwise ~ species)\ncontrasts$contrasts\n\n contrast           estimate   SE  df t.ratio p.value\n Adelie - Chinstrap    -32.4 67.5 339  -0.480  0.8807\n Adelie - Gentoo     -1375.4 56.1 339 -24.495  <.0001\n Chinstrap - Gentoo  -1342.9 69.9 339 -19.224  <.0001\n\nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nWe can easily turn this into a publication-ready table using flextable(). As the p values are so low, we will conver them to being <0.0001 where appropriate, and convert that column to a character. This gives us more control over how flextable prints the output.\nThis is appropriate here but might not be the best way in other cases.\n\ncontrasts$contrasts %>%\n  data.frame() %>%\n  mutate(p.value = ifelse(p.value < 0.0001, \"<0.0001\", as.character(round(p.value, 2)))) %>%\n  flextable() %>%\n  set_header_labels(contrast = 'Contrast',\n                    emmean = 'Estimate',\n                    SE = 's.e.',\n                    df = 'd.f.',\n                    t.ratio = \"t-ratio\",\n                    p.value = \"p value\") %>%\n  italic(j = c(3:6), part = 'header') %>% # make some column names italic\n  colformat_double(j = c(2:6), digits = 2) %>% # round numbers of specific columns to 2 decimal places\n  align(align = 'center', part = 'header') %>% # align column names centrally\n  align(align = 'left', part = 'body') %>% # align table output to the left\n  font(fontname = 'Times', part = 'all') %>% # set font name for the table\n  bold(~p.value == \"<0.0001\", j = \"p.value\") %>% # make significant p values bold\n  fontsize(size = 12, part = 'all') %>% # set font size for the table\n  autofit() # fix any random size issues\n\n\nContrastestimates.e.d.f.t-ratiop valueAdelie - Chinstrap-32.4367.51339.00-0.480.88Adelie - Gentoo-1,375.3556.15339.00-24.50<0.0001Chinstrap - Gentoo-1,342.9369.86339.00-19.22<0.0001"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Exeter Data Analytics Hub: Promoting Open and Reproducible Science",
    "section": "",
    "text": "Welcome to the homepage of the Exeter Data Analytics Hub."
  },
  {
    "objectID": "index.html#what-is-the-exeter-data-analytics-hub",
    "href": "index.html#what-is-the-exeter-data-analytics-hub",
    "title": "Exeter Data Analytics Hub: Promoting Open and Reproducible Science",
    "section": "What is the Exeter Data Analytics Hub?",
    "text": "What is the Exeter Data Analytics Hub?\nWe are an inter-college team of volunteers at the University of Exeter aiming to enhance ECR training in open and reproducible science."
  },
  {
    "objectID": "index.html#contact-us",
    "href": "index.html#contact-us",
    "title": "Exeter Data Analytics Hub: Promoting Open and Reproducible Science",
    "section": "Contact us",
    "text": "Contact us\nIf you want to help contribute to this project or have any questions about any of our content, please do not hesitate to contact us."
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "intRos: Walkthroughs",
    "section": "",
    "text": "The intRos walkthroughs are designed to be a place to provide brief introductions and walkthroughs for activities that are common when programming for research purposes. For example, using ggplot2 and making publication-ready plots. Or making reproducible tables in R using flextable. These intRos are aimed to be brief and designed to get you started using these tools. Throughout we highlight where we find information and our favourite resources for when we get stuck!\nWe hope that intRos will be added to through time by other members of the University. If you would like to contribute, please get in touch."
  },
  {
    "objectID": "posts.html#get-started",
    "href": "posts.html#get-started",
    "title": "intRos: Walkthroughs",
    "section": "Get started",
    "text": "Get started\nAll of the available intRos can be found below. All of the reproducible quarto (.qmd) files can be found at the source GitHub repository for this website. You can navigate to each of the directories individually in the posts/ folder, or better still clone the repo using git clone and open the project in RStudio."
  },
  {
    "objectID": "series.html",
    "href": "series.html",
    "title": "Open and Reproducible Science Series",
    "section": "",
    "text": "This series will include invited speakers from both within and outside the department, covering the life-cycle of a research project including Pre-registration, Project management, Reproducibility, ChatGPT (and AI in general), and more.\n\nSchedule\nWhere: Exeter University Penryn campus\nWhen: Tuesdays from 3:00-5:00pm, once a month\nFeed me?: yes, there will be tea, coffee, and snacks\n\n\n\n\n\n\n\n\nDate\nLocation\nTopic\n\n\n\n\n9th May\nExchange Red\nThe ghosts of journals past, present, and future\n\n\n6th June\nESI Trevithick\nProject management using R projects and version control\n\n\n4th July\nTBC\nWhat is open science?\n\n\n1st August\nESI Trevithick\nCoding with AI: using ChatGPT and co-pilot\n\n\n5th September\nESI Trevithick\nReproducible outputs: publication ready figures & tables\n\n\n3rd October\nESI Trevithick\nCloud computing at Exeter\n\n\nNovember\nTBC\nTBC\n\n\n\nScheduled talks subject to change as the series evolves. Please look out for calendar invites for confirmed bookings and locations.\n\n\nGet Involved\nWe welcome all levels of involvement in the series. If you would like to contribute a talk, workshop, or conversation topic on any subject linked to open and reproducible science, please get in touch with us by email or come and speak to us at an event.\nContact: a.trevail[@]exeter.ac.uk"
  },
  {
    "objectID": "index.html#open-and-reproducible-science-series",
    "href": "index.html#open-and-reproducible-science-series",
    "title": "Exeter Data Analytics Hub: Promoting Open and Reproducible Science",
    "section": "Open and Reproducible Science Series",
    "text": "Open and Reproducible Science Series\nWe host a monthly series of workshops and talks to promote Open and Reproducible Science throughout the life-cycle of a research project.\nVisit the Series page to find out more."
  },
  {
    "objectID": "index.html#intros-walkthroughs",
    "href": "index.html#intros-walkthroughs",
    "title": "Exeter Data Analytics Hub: Promoting Open and Reproducible Science",
    "section": "intRos Walkthroughs",
    "text": "intRos Walkthroughs\nFind brief introductions and walkthroughs on common research programming activities on the Walkthroughs page."
  }
]